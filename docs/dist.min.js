var e,t="readystatechange";var n=e=>`color: ${e}; font-weight: bold;`,o="#f012be";function r({component:e,e:t,module:r,color:s}){if("boolean"==typeof __DEV__&&!__DEV__)return;const c=t.type;"object"==typeof DEBUG_IGNORE&&DEBUG_IGNORE?.has(c)||(console.groupCollapsed(`${r}> %c${c}%c on %c${e}`,n(s||o),"",n("#1a80cc")),console.log(t),t.target&&console.log(t.target),console.groupEnd())}var s={};function c(e,t){if(!e)throw new Error(t)}function i(e,t){document.querySelectorAll(`.sub\\:${e}`).forEach((n=>{n.dispatchEvent(new CustomEvent(e,{bubbles:!1,detail:t}))}))}function a(n,o){c("string"==typeof o&&!!o,"Component name must be a non-empty string"),c(!s[o],`The component of the given name is already registered: ${o}`);const a=`${o}-ðŸ’Š`,d=e=>{if(!e.classList.contains(a)){e.classList.add(o),e.classList.add(a),e.addEventListener(`__unmount__:${o}`,(()=>{e.classList.remove(a)}),{once:!0});const t=new Proxy((()=>{}),{set:(t,n,r)=>(l(o,e,n,r),!0),get:(t,n)=>"outside"===n?new Proxy({},{set(t,n,s){c("function"==typeof s,`Event handler must be a function, ${typeof s} (${s}) is given`);const i=t=>{e===t.target||e.contains(t.target)||(r({module:"outside",color:"#39cccc",e:t,component:o}),s(t))};return document.addEventListener(n,i),e.addEventListener(`__unmount__:${o}`,(()=>{document.removeEventListener(n,i)}),{once:!0}),!0}}):null,apply(t,n,r){const s=r[0];if("string"==typeof s)return new Proxy({},{set:(t,n,c)=>(l(o,e,n,c,s,r[1]),!0)});if(s&&"object"==typeof s)return new Proxy({},{set:(t,n,r)=>(l(o,e,n,r,void 0,s),!0)});throw new Error(`Invalid on(...) call: ${typeof s} is given.`)}}),s=t=>e.classList.add(`sub:${t}`),u=n({el:e,on:t,pub:i,sub:s,query:t=>e.querySelector(t),queryAll:t=>e.querySelectorAll(t)});"string"==typeof u?e.innerHTML=u:u&&"function"==typeof u.then&&u.then((t=>{"string"==typeof t&&(e.innerHTML=t)}))}};d.sel=`.${o}:not(.${a})`,s[o]=d,"complete"===document.readyState?u():function(n=document){return e??=new Promise((e=>{const o=()=>{"complete"===n.readyState&&(e(),n.removeEventListener(t,o))};n.addEventListener(t,o),o()})),e}().then((()=>{u(o)}))}function l(e,t,n,o,s,i){c("function"==typeof o,`Event handler must be a function, ${typeof o} (${o}) is given`);const a=n=>{s&&![].some.call(t.querySelectorAll(s),(e=>e===n.target||e.contains(n.target)))||(r({module:"ðŸ’Š",color:"#e0407b",e:n,component:e}),o(n))};t.addEventListener(`__unmount__:${e}`,(()=>{t.removeEventListener(n,a,i)}),{once:!0}),t.addEventListener(n,a,i)}function u(e,t){let n;e?(!function(e){c("string"==typeof e,"The name should be a string"),c(!!s[e],`The component of the given name is not registered: ${e}`)}(e),n=[e]):n=Object.keys(s),n.map((e=>{[].map.call((t||document).querySelectorAll(s[e].sel),s[e])}))}function d(e,t){c(!!s[e],`The component of the given name is not registered: ${e}`),t.dispatchEvent(new CustomEvent(`__unmount__:${e}`))}export{u as mount,i as pub,a as register,d as unmount};
/*! Cell v0.1.9 | Copyright 2024 Yoshiya Hinosawa and Capsule contributors | MIT license */