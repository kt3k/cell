var e,t="readystatechange";var n=e=>`color: ${e}; font-weight: bold;`,o="#f012be";function r({component:e,e:t,module:r,color:s}){if("boolean"==typeof __DEV__&&!__DEV__)return;const i=t.type;"object"==typeof DEBUG_IGNORE&&DEBUG_IGNORE?.has(i)||(console.groupCollapsed(`${r}> %c${i}%c on %c${e}`,n(s||o),"",n("#1a80cc")),console.log(t),t.target&&console.log(t.target),console.groupEnd())}var s=class{#e;#t=[];constructor(e){this.#e=e}get(){return this.#e}update(e){this.#e!==e&&(this.#e=e,this.#t.forEach((t=>{t(e)})))}updateByFields(e){if("object"!=typeof e||null===e)throw new Error("value must be an object");for(const t of Object.keys(e))if(this.#e[t]!==e[t]){this.#e={...e},this.#t.forEach((e=>{e(this.#e)}));break}}onChange(e){return this.#t.push(e),()=>{this.#t.splice(this.#t.indexOf(e)>>>0,1)}}};function i(e){return new s(e)}var a={};function c(e,t){if(!e)throw new Error(t)}function l(n,o){c("string"==typeof o&&!!o,"Component name must be a non-empty string"),c(!a[o],`The component of the given name is already registered: ${o}`);const s=`${o}-ðŸ’Š`,i=e=>{if(!e.classList.contains(s)){e.classList.add(o),e.classList.add(s),e.addEventListener(`__unmount__:${o}`,(()=>{e.classList.remove(s)}),{once:!0});const t=(t,n,s,i)=>{if("function"==typeof n?(i=n,n=void 0,s=void 0):"function"==typeof s&&"string"==typeof n?(i=s,s=void 0):"function"==typeof s&&"object"==typeof n&&(i=s,s=n,n=void 0),"function"!=typeof i)throw new Error(`Cannot add event listener: The handler must be a function, but ${typeof i} is given`);!function(e,t,n,o,s,i){d(n),u(o);const a=n=>{s&&![].some.call(t.querySelectorAll(s),(e=>e===n.target||e.contains(n.target)))||(r({module:"ðŸ’Š",color:"#e0407b",e:n,component:e}),o(n))};t.addEventListener(`__unmount__:${e}`,(()=>{t.removeEventListener(n,a,i)}),{once:!0}),t.addEventListener(n,a,i)}(o,e,t,i,n,s)},i=(t,n)=>{d(t),u(n);const s=t=>{e===t.target||e.contains(t.target)||(r({module:"outside",color:"#39cccc",e:t,component:o}),n(t))};document.addEventListener(t,s),e.addEventListener(`__unmount__:${o}`,(()=>{document.removeEventListener(t,s)}),{once:!0})},a=n({el:e,on:t,onOutside:i,query:t=>e.querySelector(t),queryAll:t=>e.querySelectorAll(t)});"string"==typeof a?e.innerHTML=a:a&&"function"==typeof a.then&&a.then((t=>{"string"==typeof t&&(e.innerHTML=t)}))}};i.sel=`.${o}:not(.${s})`,a[o]=i,"complete"===document.readyState?f():function(n=document){return e??=new Promise((e=>{const o=()=>{"complete"===n.readyState&&(e(),n.removeEventListener(t,o))};n.addEventListener(t,o),o()})),e}().then((()=>{f(o)}))}function u(e){c("function"==typeof e,`Cannot add an event listener: The event handler must be a function, ${typeof e} (${e}) is given`)}function d(e){c("string"==typeof e,`Cannot add an event listener: The event type must be a string, ${typeof e} (${e}) is given`)}function f(e,t){let n;e?(!function(e){c("string"==typeof e,"The name should be a string"),c(!!a[e],`The component of the given name is not registered: ${e}`)}(e),n=[e]):n=Object.keys(a),n.map((e=>{[].map.call((t||document).querySelectorAll(a[e].sel),a[e])}))}function h(e,t){c(!!a[e],`The component of the given name is not registered: ${e}`),t.dispatchEvent(new CustomEvent(`__unmount__:${e}`))}export{f as mount,l as register,i as signal,h as unmount};
/*! Cell v0.3.6 | Copyright 2024 Yoshiya Hinosawa and Capsule contributors | MIT license */